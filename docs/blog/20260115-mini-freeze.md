
# 2025/01/15 プチフリ

## 要約

Realtek Gaming GbE Family Controllerの省電力機能を無効化することでプチフリが解消した。

## 症状

Windows 11 Pro - Version 24H2 (OS ビルド 26100.7623)

PCを起動してから4時間ほど経過した後、BF6プレイ開始と同時にプチフリが発生し始めた。BF6終了後は何のアプリを起動していない状態でもプチフリが継続する。
ゲーム中は**5-20秒に5秒程度、それ以外の時は10-60秒に5秒程度のプチフリが発生**する。プチフリ中はマウスカーソルを除く画面が固まり、一部音声が途切れる。（再生中のセリフなどは継続して聞こえ、足音などの新しい音声は発生しない。）
同日に2XKOをインストールおよびその後に再起動していた。


## 原因調査

イベントビューアー > Windowsログ > システム
でエラーを確認したところ、

- ```Realtek Gaming GbE Family Controller has a Hardware IO error.```  
  というエラーが1回
- ```ネットワーク インターフェイス "Realtek Gaming GbE Family Controller" はリセットを開始しました。ハードウェア リセットの間にネットワーク接続が一時的に中断します。（後略）```  
  という警告が2-3回

の組がプチフリ発生のタイミングで繰り返し記録されていた。

cf: [PCのプチフリーズをGeminiと共に解決した話 | azperoly](https://note.com/azperoly/n/n1b679bcde4d9#2e6a995d-dde5-4807-9194-466354a1fc11)

## 解決

Geminiに聞いたところ、

> LANアダプター（Realtek）のドライバ、あるいは省電力機能がハードウェアと衝突して応答停止（ハングアップ）を引き起こし、OSがそれを復旧させようとしてシステム全体が止まっている状態

ではないか、とのこと。
指示に従い、以下を実施した。

> ### 1. ネットワークアダプターの省電力設定をオフにする
> 
> 1. **スタートボタン**を右クリックし、「**デバイス マネージャー**」を開きます。
> 2. 「**ネットワーク アダプター**」を展開し、「**Realtek Gaming GbE Family Controller**」をダブルクリックします。
> 3. 「**電源の管理**」タブを開き、**「電力の節約のために、コンピューターでこのデバイスの電源をオフにできるようにする」のチェックを外します。**
> 4. 「OK」を押して、PCを再起動して様子を見ます。

これでは改善しなかった。

> ### 2. ドライバの「詳細設定」を変更する
> 
> Realtekのドライバにある高度な省電力機能を無効化します。
> 
> 1. 先ほどと同じデバイスマネージャーのプロパティで、「**詳細設定**」タブを開きます。
> 2. リストから以下の項目を探し、すべて「**無効 (Disabled)**」に変更してください。
>     * **Energy Efficient Ethernet**（省電力イーサネット）
>     * **Green Ethernet**（グリーン イーサネット）
>     * **Power Saving Mode**（省電力モード）
> 
> 3. ついでに、**「一括送信オフロード (Large Send Offload / LSO)」**も「無効」にすると安定性が増す場合があります。

この後に再起動したところ、プチフリが発生しなくなった。

なお、Geminiからは以下の追加対策も提案されていた。

> - 最新ドライバへの更新（またはロールバック）
> - 高速スタートアップの無効化
> - LANケーブルやポートの確認


## tips

「プチ」はフランス語の「petit」に由来し、「プチフリ」は英語では「mini freeze」などと表現される。
